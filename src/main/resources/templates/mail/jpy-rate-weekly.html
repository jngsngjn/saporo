<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8"/>
    <title>엔화 환율 알림</title>
    <style>
        body { font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR",Arial,sans-serif; margin:0; padding:24px; background:#f6f7f9; text-align:left; }

        .card { width:640px; max-width:100%; margin:0; background:#fff; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.06); overflow:hidden; }

        /* HEADER */
        .header { display:flex; align-items:center; padding:16px 20px; background:#111827; color:#fff; gap:12px; }
        .header-left { display:flex; align-items:center; gap:10px; }
        .header-title { font-size:18px; font-weight:700; line-height:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
        .header-sub { font-size:13px; font-weight:500; color:#cbd5e1; line-height:1.2; margin-left:10px; }
        .header-icons { margin-left:auto; display:flex; align-items:center; gap:8px; font-size:18px; line-height:1.2; }

        .content { padding:24px; color:#111827; }
        .row { margin:8px 0; }
        .value { font-size:28px; font-weight:800; margin-top:6px; display:flex; align-items:center; gap:8px; }
        .muted { color:#6b7280; font-size:13px; }
        .footer { padding:16px 24px; background:#f3f4f6; color:#6b7280; font-size:12px; }
        .mono { font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Courier New",monospace; }

        .badge { display:inline-block; padding:6px 10px; border-radius:9999px; font-size:12px; font-weight:700; line-height:1; }
        .badge-high { background:#fee2e2; color:#b91c1c; }
        .badge-low  { background:#dbeafe; color:#1d4ed8; }
        .badge-ok   { background:#e5e7eb; color:#374151; }

        .high-rate { color:#dc2626; }
        .low-rate  { color:#2563eb; }

        .yesterday-text { color:#6b7280; font-size:13px; font-weight:400; }

        /* 표 */
        .table-title { font-size:14px; font-weight:600; margin-top:20px; margin-bottom:8px; color:#374151; }
        table { width:100%; border-collapse:collapse; margin-top:8px; }
        th, td { padding:10px 8px; text-align:left; border-bottom:1px solid #f1f5f9; font-size:15px; } /* 기본 폰트 약간 키움 */
        th { color:#374151; font-size:16px; font-weight:700; text-transform:none; } /* 헤더 글씨 크게 & 진하게 */
        .right { text-align:right; }
    </style>
</head>
<body>
<div class="card">
    <div class="header">
        <div class="header-left">
            <div class="header-title">엔화 환율 알림 💴</div>
            <div class="header-sub" th:text="${'(' + sentAt + ')'}">(2025-08-16 12:45 KST)</div>
        </div>
        <div class="header-icons" aria-hidden="true">
            <span>🇯🇵</span><span>☃️</span>
        </div>
    </div>

    <div class="content">
        <!-- 상태 배지 -->
        <div class="row">
            <span class="badge"
                  th:classappend="${rate >= maxValue} ? ' badge-high' : (${rate <= minValue} ? ' badge-low' : ' badge-ok')"
                  th:text="${rate >= maxValue} ? '때를 기다리세요..' : (${rate <= minValue} ? '어머, 이건 사야돼!' : '정상 범위')">
                정상 범위
            </span>
        </div>

        <!-- 현재 환율 -->
        <div class="row">
            <div class="value">
                <span class="mono"
                      th:text="${'1 JPY = ' + #numbers.formatDecimal(rate, 1, 2) + ' KRW'}"
                      th:classappend="${rate >= maxValue} ? ' high-rate' : (${rate <= minValue} ? ' low-rate' : '')">
                    1 JPY = 9.50 KRW
                </span>
            </div>
        </div>

        <!-- 전일 환율 -->
        <div class="row" th:if="${yesterdayRate != null}">
            <div class="yesterday-text">
                <span th:text="${'(어제 환율: ' + #numbers.formatDecimal(yesterdayRate, 1, 2) + ' KRW)'}">
                    (어제 환율: 9.30 KRW)
                </span>
            </div>
        </div>

        <hr style="margin:24px 0; border:none; border-top:1px solid #e5e7eb;">

        <!-- 주간 표 -->
        <div class="table-title">지난 일주일간 환율 정보입니다.</div>
        <table>
            <thead>
            <tr>
                <th>날짜</th>
                <th class="right">환율 (1 JPY = KRW)</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="d : ${days}">
                <td th:text="${#temporals.format(d.date, 'yyyy-MM-dd')}">2025-08-10</td>
                <td class="right">
                    <span class="mono" th:if="${d.rate != null}" th:text="${#numbers.formatDecimal(d.rate,1,2)}">9.30</span>
                    <span th:if="${d.rate == null}">-</span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="footer">
        본 메일은 자동 발송되었습니다. 환율 정보는 제공 지연/오차가 있을 수 있습니다.
    </div>
</div>
</body>
</html>